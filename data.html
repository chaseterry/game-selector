<!doctype html>
<html>
<!-- comment-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="author" content="co-authored by Brandon Post, Chase Terry">
    <title>Game Selector</title>
    
    <!-- JQuery Mobile Setup -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
    <!-- End JQuery Mobile Setup -->
    

    <script>
      //javascript
      
      var games = [];
      
      function game(name, isBoard, isCard, categoryArray, duration, minPlayers, maxPlayers, appletArray){
        this.name = name;
        this.isBoard = isBoard;
        this.isCard = isCard;
        this.categoryArray = categoryArray;
        this.duration = duration;
        this.minPlayers = minPlayers;
        this.maxPlayers = maxPlayers;
        this.appletArray = appletArray;
      }
      
      function addToDatabase(object){
        if(hasLocalStorage()){
          if(localStorage.database){
            alert("Submited: "+object.name);
            //games.sort(function(a, b){return a.name.localeCompare(b.name)});
            var oldDatabase = JSON.parse(localStorage.database);
            games = oldDatabase;
            games.push(object);
            localStorage.database = JSON.stringify(games);
          } 
          else{
            //alert("first");
            localStorage.database = JSON.stringify(games);
          }
          var temp = JSON.parse(localStorage.database);
        }
        else{
          alert("No HTML5 Local Storage");
        }
      }
      
      function dataInput(){
        var name = document.getElementById("game-name").value;
        var isBoard = !!(document.getElementById("board-or-card").value);
        var isCard = !(document.getElementById("board-or-card").value);
        var catArray = [$('#strategy').is(':checked'), $('#action').is(':checked')];
        var duration = document.getElementById("duration").value;
        var min = document.getElementById("min-players").value;
        var max = document.getElementById("max-players").value;
        var appArray = [$('#dice').is(':checked'), $('#starting-player').is(':checked')];
        var game1 = new game(name, isBoard, isCard, catArray, duration, min, max, appArray);
        addToDatabase(game1);
      }
      
      function deleteGame(number){
        //alert("Attempt delete");
        //alert("test: "+number);
        //return;
        var newGames = [];
        number--;
        for(i = 0; i < number; i++)
        {
          newGames.push(games[i]);
        }
        for(j = number + 1; j < games.length; j++)
        {
          newGames.push(games[j]); 
        }
        alert("deleted: "+games[number].name);
        games = newGames;
        localStorage.database = JSON.stringify(games);
        showList();
      }
      
      function editGame(number){
        alert("Edit: "+number);
      }
      
      function deleteAllGames(){
        games = [];
        if(hasLocalStorage()){
          if(localStorage.database){
            games = [];
            localStorage.database = JSON.stringify(games);
          } 
          else{
            games = [];
            localStorage.database = JSON.stringify(games);
          }
        }
        else{
          alert("No HTML5 Local Storage");
        }
        showList();
      }

      
      //All testing
      function clickCounter(){
        alert("Still broken");
        if(hasLocalStorage()){
          if(localStorage.clickcount){
            alert("next");
            localStorage.clickcount = Number(localStorage.clickcount)+1;
          } 
          else{
            alert("first");
            localStorage.clickcount = 1;
          }
          document.getElementById("clickcount-data").innerHTML = "You have clicked the button " + localStorage.clickcount + " time(s).";
        }
        else{
          alert("No HTML5 Local Storage");
        }
        alert("pass through");
      }
      
      function hasLocalStorage(){
        if(typeof(Storage) !== "undefined"){
          //has local storage
          return true;
        }
        else{
          //does not have local storage
          return false;
        }
      }
      
      function showList(){
        if(hasLocalStorage()){
          document.getElementById("res1").innerHTML = "";
          document.getElementById("res2").innerHTML = "";
          document.getElementById("res3").innerHTML = "";
          document.getElementById("res4").innerHTML = "";
          document.getElementById("res5").innerHTML = "";
          document.getElementById("res6").innerHTML = "";
          document.getElementById("res7").innerHTML = "";
          document.getElementById("res8").innerHTML = "";
          document.getElementById("res9").innerHTML = "";
          document.getElementById("res10").innerHTML = "";
          var newDatabase = JSON.parse(localStorage.database);
          document.getElementById("res1").innerHTML = newDatabase[0].name;
          document.getElementById("res2").innerHTML = newDatabase[1].name;
          document.getElementById("res3").innerHTML = newDatabase[2].name;
          document.getElementById("res4").innerHTML = newDatabase[3].name;
          document.getElementById("res5").innerHTML = newDatabase[4].name;
          document.getElementById("res6").innerHTML = newDatabase[5].name;
          document.getElementById("res7").innerHTML = newDatabase[6].name;
          document.getElementById("res8").innerHTML = newDatabase[7].name;
          document.getElementById("res9").innerHTML = newDatabase[8].name;
          document.getElementById("res10").innerHTML = newDatabase[9].name;

         // var x = 1;
          //document.getElementById("result-1").innerHTML = "<li <p>" + newDatabase[x].name + "</p><a onclick='deleteGame("+x+");'>H</a></li>"
          //document.getElementById("result-2").innerHTML = "<li id='result-2' data-icon='delete'>"+newDatabase[x].name+"<a onclick='deleteGame()'>data-icon='delete'</a></li>";
          //document.getElementById("result-3").innerHTML = ""+newDatabase[x].name+"<a onclick='deleteGame(10)'>data-icon='delete'</a></li>";
          //document.getElementById("result-4").innerHTML = computeResult(4);
          //document.getElementById("result-5").innerHTML = newDatabase[1].name;
          //document.getElementById("result-6").innerHTML = computeResult(6);
          //for(i = 7; i<8; i++)
          //{
          //document.getElementById("result-7").innerHTML = '<li id="result-7"><a onclick="" id="res6">Result-7</a><a onclick="deleteGame(7);">result-7</a></li>';

          //}
          //document.getElementById("result-8").innerHTML =  'id="result-8"><a onclick="" id="res8">Result-8</a><a onclick="deleteGame(8);">result-8</a></li>';

          
        }
      }
      
      
    </script>
  </head>
  <body>
    <!-- main html -->
    <div data-role="page" id="datapage">
      <div data-role="header">
        <h1>Game Selector</h1>
      </div><!-- /header -->
      
      <div data-role="navbar" class="header">
        <ul>
          <li><a href="data.html" data-transition="fade" class="ui-btn-active ui-state-persist">Data</a></li>
          <li><a href="index.html" data-transition="slide" rel="external">Home</a></li>
          <li><a href="extras.html" data-transition="slide" rel="external">Extras</a></li>
        </ul>
      </div> <!-- navbar -->
      
      
      <div data-role="main" class="ui-content">
        <!--
        <h3>Local Storage testing</h3>
        <p id="clickcount-data">Hello</p>
        <p><a data-role="button" data-inline="true" onclick="clickCounter();">Increase Counter!</a></p>   
        -->
        <a href="#edit" data-role="button" data-mini="true" align="right" onclick="showList();" data-inline="true" data-transition="none">Edit/view list</a>
        <form align="center">
          <h1>Game Input:</h1>
          <label for="game-name">Name of Game:</label>
          <input type="text" name="game-name" id="game-name" data-clear-btn="true">
          <label for="board-or-card">Board or Card game:</label>
            <select name="slider" id="board-or-card" data-role="slider">
              <option value="board">Board</option>
              <option value="card">Card</option>
            </select>
          <fieldset data-role="controlgroup">
            <legend>Select All Categories:</legend>
            <label for="strategy">Strategy</label>
            <input type="checkbox" name="strategy" id="strategy">
            <label for="action">Action</label>
            <input type="checkbox" name="action" id="action">
          </fieldset>
          <label for="duration">Game Duration:</label>
          <input type="range" name="duration" id="duration" min="15" max="180" value="30">
          <label for="min-players">Minimum number of players:</label>
          <input type="range" name="min-players" id="min-players" min="1" max="10" value="2">
          <label for="max-players">Maximum number of players:</label>
          <input type="range" name="max-players" id="max-players" min="1" max="15" value="4">
          <fieldset data-role="controlgroup">
            <legend>Associated Applets:</legend>
            <label for="dice">Dice</label>
            <input type="checkbox" name="dice" id="dice">
            <label for="starting-player">Starting player selector</label>
            <input type="checkbox" name="starting-player" id="starting-player">
          </fieldset>
          <!--<input type="submit" value="Submit" data-icon="check" data-iconpos="right" data-inline="true">-->
        </form>
        <a data-role="button" data-inline="true" onclick="dataInput();">Submit</a>
      </div><!-- /content -->
    </div><!-- /page -->
    
    <div data-role="page" id="edit">
      <div data-role="header">
        <h1>Game Selector</h1>
      </div><!-- /header -->
      
      <div data-role="navbar" class="header">
        <ul>
          <li><a href="data.html" data-transition="fade" class="ui-btn-active ui-state-persist">Data</a></li>
          <li><a href="index.html" data-transition="slide" rel="external">Home</a></li>
          <li><a href="extras.html" data-transition="slide" rel="external">Extras</a></li>
        </ul>
      </div> <!-- navbar -->
      
      <div data-role="main" class="ui-content">
        <a href="#datapage" data-role="button" data-mini="true" align="right" data-inline="true" data-transition="none">Go back</a>
        <a href="#datapage" data-role="button" data-mini="true" align="right" onclick="deleteAllGames();" data-inline="true" data-transition="none">Delete all games</a>

        <h1 align="center" >List:</h1>
        <ul data-role="listview" data-split-icon="delete" data-filter="true" data-inset="true" align="center">
          <li id="result-1"><a onclick="" id="res1"></a><a href="#datapage" onclick="deleteGame(1);" data-transition="none">result-1</a></li>
          <li id="result-2"><a onclick="" id="res2"></a><a href="#datapage" onclick="deleteGame(2);" data-transition="none">result-2</a></li>
          <li id="result-3"><a onclick="" id="res3"></a><a href="#datapage" onclick="deleteGame(3);" data-transition="none">result-3</a></li>
          <li id="result-4"><a onclick="" id="res4"></a><a href="#datapage" onclick="deleteGame(4);" data-transition="none">result-4</a></li>
          <li id="result-5"><a onclick="" id="res5"></a><a href="#datapage" onclick="deleteGame(5);" data-transition="none">result-5</a></li>
          <li id="result-6"><a onclick="" id="res6"></a><a href="#datapage" onclick="deleteGame(6);" data-transition="none">result-6</a></li>
          <li id="result-7"><a onclick="" id="res7"></a><a href="#datapage" onclick="deleteGame(7);" data-transition="none">result-7</a></li>
          <li id="result-8"><a onclick="" id="res8"></a><a href="#datapage" onclick="deleteGame(8);" data-transition="none">result-8</a></li>
          <li id="result-9"><a onclick="" id="res9"></a><a href="#datapage" onclick="deleteGame(9);" data-transition="none">result-9</a></li>
          <li id="result-10"><a onclick="" id="res10"></a><a href="#datapage" onclick="deleteGame(10);" data-transition="none">result-10</a></li>
          <!--
          <li id="result-7"></li>
          <li id="result-8"></li>
          -->
        </ul>
        
      </div><!-- /content -->
    </div><!-- /page -->
    
    
  </body>
</html>
